<html>
<head><title>Magic Clover</title><link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="http://aschatria.github.io/assets/css/wshell.css">
  
  
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script type="text/javascript">
counter = function() {
    var value = $('#markdown').val();

    if (value.length == 0) {
        $('#wordCount').html(0);
        $('#totalChars').html(0);
        $('#charCount').html(0);
        $('#charCountNoSpace').html(0);
        return;
    }

    var regex = /\s+/gi;
    var wordCount = value.trim().replace(regex, ' ').split(' ').length;
    var totalChars = value.length;
    var charCount = value.trim().length;
    var charCountNoSpace = value.replace(regex, '').length;

    $('#wordCount').html(wordCount);
    $('#totalChars').html(totalChars);
    $('#charCount').html(charCount);
    $('#charCountNoSpace').html(charCountNoSpace);
};

$(document).ready(function() {
    $('#markdown').change(counter);
    $('#markdown').keydown(counter);
    $('#markdown').keypress(counter);
    $('#markdown').keyup(counter);
    $('#markdown').blur(counter);
    $('#markdown').focus(counter);
});
</script>
  
  </head>

 <body>
   
    <!-- made based on steemwhales post page thanks to @heimindanger -->
<div class="container-fluid" style="background-color: #ffefdb;">
   
   
   <!-- Image and text -->
<nav class="navbar navbar-light" style="background-color:#ffec8b; justify-content-between">
  <span class="navbar-brand">STEEM Magic Clover</span>
  <form class="form-inline" style="float:right;">
  
         
          <input id="author" name="author" type="text" placeholder="username" class="form-control input-md" required="">
         
    
          <input id="privatekey" name="privatekey" type="text" placeholder="Posting Key" class="form-control input-md" required="">
          
          <label control-label" for="privatekey">
            <button style="background:#ffd5c0!important;" type='button' id="addbenef" name="addbenef" class="btn btn-outline-success" data-toggle="modal" data-target="#benefModal"><span class="glyphicon glyphicon-piggy-bank" aria-hidden="true"></span> Add SP reward</button>
          </label>
          <div class="col">
          <ul id='beneflist'>
          </ul>
          </div>
        

  </form>
  
  
  
</nav>
   
      
  
          

  <div class="col" style="background:#1C252B;color:white;padding:10px;height:auto;width:30%;float:left;">
            
        
            
  Magic Clover is basic posting app for STEEM. <br/>
  <span style="color:#ff7256;">You can post with this form, it is free, use it for your own purposes, add any random person you like to reward with SP, your family, friends, people on Steemit, without any limitations.</span></br>
  Usage of this form is completely up to you.</br>
     <hr/>  
     
  <p>The posting key is not saved by this form and exists only in your browser until you close this page.</p>
       <hr/>                                                                                     
	You can edit this post additionally in Steemit.</br>
	Benefactor, main tag and reward options once set can't be changed.</br>																																													
				<hr/>
    <b>Markdown</b>                                                                                    
 
   <br/>Insert images with this code: <blockquote>![image name](link to image) </blockquote>   
   <br/>Insert link with this code: <blockquote> [link description](link) </blockquote>                                                                                            
     <hr/>
  DISCLAIMER: 
   We ( hosting party, github account holder) won't be held responsible for any possible finantial loss by misuse of this form or failure to understand its purpose and settings. </br>
   Don't change settings if you don't know what they are for.  </br>                                                                                       
   By using this form you are in full compliance with this disclaimer.  </br> 
 <hr/>
Magic Clover is maintained by <a href="https://steemit.com/@aschatria">@aschatria</a> 

<hr/>
     <center><img src="https://i.imgur.com/5IwlmBL.png"/></center>
  </div>
  
         
  
  <div class="col-6" style="padding:10px;width:64%;float:right;">
  
  <form class="form-horizontal" id='post'>
        <fieldset>

        <!-- Form Name -->
        <center><legend>Post content on STEEM</legend></center>
           

        <!-- Text input-->
        <div class="form-group">
          <label class="col control-label" for="title">Title<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></label>  
          <div class="col">
          <input id="title" name="title" type="text" placeholder="Write your title here" class="form-control input-md" required="">
          </div>
        </div>

        <!-- Text input-->
        <div class="form-group">
          <label class="col control-label" for="permlink">Link<span class="glyphicon glyphicon-link" aria-hidden="true"></span></label>  
          <div class="col">
          <input id="permlink" name="permlink" type="text" placeholder="Link will be auto-added when you write a title" class="form-control input-md" required="">
          </div>
        </div>
          
          
          
          <!-- Textarea -->
        <div class="form-group">
          <label class="col control-label" for="cover">Cover image<span class="glyphicon glyphicon-picture" aria-hidden="true"></span></label>
          <div class="col">
            <textarea class="form-control" id="cover" name="cover" rows='2' placeholder="Paste URL of your cover image or YouTube video, or excerpt. "></textarea>
                                                                                                                                                      
              <hr/>
                                                                                                                                                      
                                                                                                                                                      <div style="width:100%";><b>Free media search; copy image link for your cover.</b><br/>
                           <b>Youtube search</b>
You can also swap codes like this and create a cover from a Youtube video.<br/>
         https://www.youtube.com/watch?v=CODE<br/>
         https://img.youtube.com/vi/CODE/sddefault.jpg<br/>   <br/>                                                                                                                        
                 
                                     
              <script>
  (function() {
    var cx = '006910737071782307290:jhlsrcm5de4';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

              
            </div>  
  
            
                                                                                                                                                      
          </div>
        </div>  
          
          

        <!-- Textarea -->
        <div class="form-group">
          <label class="col control-label" for="markdown">Content<span class="glyphicon glyphicon-file" aria-hidden="true"></span></label>
          <div class="col">
            <textarea class="form-control" id="markdown" name="markdown" rows='12'></textarea>
              
        <div id="result">
            Words: <span id="wordCount">0</span><br/>
            Total Characters(including trails): <span id="totalChars">0</span><br/>
            Characters (excluding trails): <span id="charCount">0</span><br/>
            Characters (excluding all spaces): <span id="charCountNoSpace">0</span>
        </div>
          </div>
        </div>
          <hr/>
                                                                          
    <!-- divider-->
        <div class="form-group">
          <label class="col control-label" for="divider">Text Divider<span class="glyphicon glyphicon-sound-stereo" aria-hidden="true"></span></label>  
          <div class="col">
 <textarea class="form-control" id="divider" name="divider" rows='1' placeholder=""><hr/></textarea>
<span class="help-block">Paste your text divider, use default or use one from the list.</span>
          </div>

<img src="https://i.imgur.com/7FdwTkLm.png" title="source: imgur.com" />                        
<textarea class="form-control" rows='1'><img src="https://i.imgur.com/7FdwTkL.png"/></textarea>

<img src="https://i.imgur.com/4gE8D6Am.png" title="source: imgur.com" />                                                                                  
<textarea class="form-control" rows='1'><img src="https://i.imgur.com/4gE8D6A.png"/></textarea>
 
<img src="https://i.imgur.com/76LNV99m.png"/>                                                                                     
<textarea class="form-control" rows='1'><img src"https://i.imgur.com/76LNV99.png"/></textarea>

<img src="https://i.imgur.com/cDGWpd9m.png"/>                                                                                 
<textarea class="form-control" rows='1'><img src"https://i.imgur.com/cDGWpd9.png"/></textarea>
                              
        </div>                                                                      
          <hr/>
          
          <!-- Textarea -->
        <div class="form-group">
          <label class="col control-label" for="resources">Resources<span class="glyphicon glyphicon-certificate" aria-hidden="true"></span></label>
          <div class="col">
            <textarea class="form-control" id="resources" name="resources" rows='4' placeholder="Paste links to your free attribution  images (image attribution) or resources.">
            <h2>Resource box</h2>
            <b>Image Attribution Links:</b><br/>
            Paste links here, or delete this text if you don't need it.</textarea>
          </div>
        </div> 
          
          
          
        <!-- Textarea -->
        <div class="form-group">
          <label class="col control-label" for="branding">Branding<span class="glyphicon glyphicon-certificate" aria-hidden="true"></span></label>
          <div class="col">
            
            <textarea class="form-control" id="branding" name="branding" rows='4' placeholder="Paste codes for banners and your footer"></textarea>
            
          </div>
        </div>  
          
      <hr/>
          
          
          <!-- Text input-->
        <div class="form-group">
          <label class="col control-label" for="tags">Tags<span class="glyphicon glyphicon-tags" aria-hidden="true"></span></label>  
          <div class="col">
          <input id="tags" name="tags" type="text" placeholder="Add 1-4 tags, space separated, add space after last one " class="form-control input-md" required="">
          <span class="help-block"></span>
          </div>
        </div>
          
          
          
   <hr/>    
          <center><h3>Payout</h3></center>
          
<span class="help-block">You will get <span id='weightRemaining'>100</span>% of the rewards</span> 
          
          
        <!-- Text input-->
      <div class="form-group">
          <label class="col-md-4 control-label" for="sbdpercent">Steem Dollars %</label>  
          <div class="col-md-4">
          <input id="sbdpercent" name="sbdpercent" type="number" placeholder="" class="form-control input-md" required="" min='0' max='100' value='100' step='0.01'>
          <span class="help-block">Set to 0% if you want to power up all your rewards</span> 
           <span class="help-block">Leave as it is to receive a full reward.</span>                        
          </div>
        </div>



        <!-- Text input-->
      <div class="form-group">
          <label class="col-md-4 control-label" for="maxpayout">Max Accepted SBD Payout</label>  
          <div class="col-md-4">
          <input id="maxpayout" name="maxpayout" type="number" placeholder="" class="form-control input-md" required="" min='0' max='1000000' value='1000000' step='1'>
          <span class="help-block">Set to 0 if you want to decline payout</span>
     <span class="help-block">Leave as it is if you want to receive full payout. </span> 
          </div>
        </div>

        <!-- Button -->
        <div class="form-group">
          <label class="col-md-4 control-label" for="post"></label>
          <div class="col-md-4">
            <button style="background:#ffd5c0!important;color:black;" id="post" name="post" class="btn btn-primary"><span class="glyphicon glyphicon-fire" aria-hidden="true"></span>SEND</button>
          </div>
        </div>

        </fieldset>
      </form>
    
    
 
     
     <center><img src="https://i.imgur.com/A01eQzv.png"/><br/>
     <a href="https://discord.gg/FqpQ7AV">https://discord.gg/FqpQ7AV</a> </center>                                         
            
  </div>

 

      <!-- Modal -->
      <div class="modal fade" id="benefModal" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Add SP reward</h4>
            </div>
            <div class="modal-body">
              
           People you add will receive SP reward share from your post.
              
              <hr/>
             
              
              
              <form class="form-horizontal" id='post'>
                <fieldset>


                <!-- Text input-->
                <div class="form-group">
                  <label class="col-md-4 control-label" for="benefusername">Receiver</label>  
                  <div class="col-md-4">
                  <input id="benefusername" name="benefusername" type="text" placeholder="" class="form-control input-md" required="" value='username'>
                  <span class="help-block"></span>  
                  </div>
                </div><br/>

                <!-- Text input-->
                <div class="form-group">
                  <label class="col-md-4 control-label" for="benefshare">Reward % of your post</label>  
                  <div class="col-md-4">
                  <input id="benefshare" name="benefshare" type="number" placeholder="" class="form-control input-md" required="" min='1' max='10000000' value='1' step='1'>
                  <span class="help-block"></span>  
                  </div>
                </div>

                </fieldset>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-success" data-dismiss="modal" id='benefadd'>Add</button>
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
                                                                                
         <div class="alert alert-primary" role="alert">                                                                       
      <div id='successalert' class="alert alert-success" style='display:none'>
        <strong>Success!</strong> Your post is now public on the blockchain.
      </div>

      <div id='infoalert' class="alert alert-info" style='display:none'>
        <strong>Please wait</strong> Submitting your post...
      </div>

      <div id='erroralert' class="alert alert-danger" style='display:none'>
        <strong>Error!</strong> <span id='errormessage'></span>
      </div>
    </div>
     </div>                                                
                                                     
  
  
  
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="http://aschatria.github.io/assets/js/jquery.query-object.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
   <script src="https://cdn.steemjs.com/lib/latest/steem.min.js"></script>
  
  
  
  
  
    <script type="text/javascript">
      beneficiaries = []
      weightRemaining = 10000
      tags = []

      $('#title').keydown(function() {
        var permlink = $(this).val().toLowerCase()
          .replace(/ /g,'-')
          .replace(/[^\w-]+/g,'')
        $('#permlink').val(permlink)
      })

      $('#tags').keydown(function() {
        tags = $(this).val().split(' ')
      })

      $('#benefadd').click(function() {
        for (var i = beneficiaries.length - 1; i >= 0; i--) {
          if (beneficiaries[i].account == $('#benefusername').val()) {
            weightRemaining += beneficiaries[i].weight;
            beneficiaries.splice(i,1);
          }
        };
        beneficiaries.push({
          account: $('#benefusername').val(),
          weight: 100*$('#benefshare').val()
        })
        weightRemaining -= 100*$('#benefshare').val()
        displayBenefs()
      })

      function displayBenefs() {
        $('#beneflist').empty()
        for (var i = beneficiaries.length - 1; i >= 0; i--) {
          var html = '<li>'+beneficiaries[i].account+' ('+beneficiaries[i].weight/100+'%) <button type="button" class="btn btn-danger btn-xs removeBenef" data-account="'+beneficiaries[i].account+'">x</button></li>'
          $('#beneflist').append(html)
        };
        $('#weightRemaining')[0].innerHTML = weightRemaining/100;
        $('.removeBenef').click(function(e) {
          console.log($(this).data('account'))
          for (var i = beneficiaries.length - 1; i >= 0; i--) {
            if (beneficiaries[i].account == $(this).data('account')) {
              weightRemaining += beneficiaries[i].weight;
              beneficiaries.splice(i,1);
              displayBenefs()
            }
          };
        })
      }

      $('#post').submit(function(event) {
        event.preventDefault();
        $('#infoalert').show()
        $('#successalert').hide()
        $('#erroralert').hide()
        var title = $('#title').val();
        var permlink = $('#permlink').val();
        var markdown = '<strong>' + $('#cover').val() + '</strong>' + $('#divider').val() + $('#markdown').val() + '$('#divider').val()' + $('#resources').val() +'$('#divider').val()' +  $('#branding').val() + $('#divider').val() + '<center><img src="https://i.imgur.com/5IwlmBL.png"/><br/><b>This is posted using Magic Clover STEEM app.</b><br/><a href="https://aschatria.github.io/steem/magic-clover.html">Website- Learn More</a><br/><a href="https://discord.gg/NAancrq">Discord server - Join Us</a></center>';
        var author = $('#author').val();
        var privatekey = $('#privatekey').val();
        var sbdpercent = 100*$('#sbdpercent').val();
        var maxpayout = parseInt($('#maxpayout').val());

        var operations = [
          ['comment',
            {
              parent_author: '',
              parent_permlink: tags[0],
              author: author,
              permlink: permlink,
              title: title,
              body: markdown,
              json_metadata : JSON.stringify({
                tags: tags,
                app: 'STEEM Magic Clover'
              })
            }
          ],
          ['comment_options', {
            author: author,
            permlink: permlink,
            max_accepted_payout: maxpayout+'.000 SBD',
            percent_steem_dollars: sbdpercent,
            allow_votes: true,
            allow_curation_rewards: true,
            extensions: [
              [0, {
                beneficiaries: beneficiaries
              }]
            ]
          }]
        ];

        if (beneficiaries.length == 0) {
          operations[1][1].extensions = []
        }

        console.log(operations)
        steem.broadcast.send(
          { operations: operations, extensions: [] },
          { posting: privatekey },
          function(e, r) {
            $('#infoalert').hide()
            if (e) {
              $('#errormessage').html(e.message)
              $('#erroralert').show()
            } else {
              $('#successalert').show()
            }
            console.log(e,r)
          }
        )
      });
    </script>

  
  
  


</body>
</html>
